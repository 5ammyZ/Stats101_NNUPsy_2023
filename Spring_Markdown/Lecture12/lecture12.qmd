---
format: 
  revealjs:
    slide-number: true
    logo: images/image-393370223.png
    scrollable: true 
    theme: theme.scss
editor: visual
fontsize: 24pt
---

</br></br>

<h1 style="text-align: center">

12 - 假设检验(3)

</h1>

<h2 style="text-align: center">

(Hypothesis testing 3: Two types of errors & power analysis)

</h2>

</br></br>

<h3 style="text-align: center">

Hu Chuan-Peng

</h3>

<h3 style="text-align: center">

2023-05-17

</h3>

</br></br>

## Review

</br></br>

-   *p*值及其计算;</br></br>

-   *p*值的误用;</br></br>

-   误用*p*值的危害

## 假设检验步骤

</br></br>

-   提出假设;</br></br>

-   根据虚无假设$H_0$所提供的前提条件，选择合适的统计模型;</br></br>

-   规定显著性水平$\alpha$;</br></br>

-   计算检验统计量的值;</br></br>

-   做出决策

# NHST框架下的两类错误

## 

</br></br>

南京某创造力培训班声称他们培训非常有效，在他们培训结束后36个6岁幼儿平均创造力潜质为105。假定正常的6岁幼儿的创造力潜质分数为100，标准差为15， 家长们想要了解该培训班是否真的有效，该如何决策？

## 

![](images/image-1948617480.png){fig-align="center"}

## 

</br></br>

$H_0$成立下，出现培训后的6岁幼儿这样"高"创造力潜质的概率*p*$< \alpha$，不太可能在一次抽样中出现，所以我们拒绝$H_0$。

## 

</br></br>

-   研究假设/对立假设/备择假设(Alternative Hypothesis)

    -   $H_1$:与零假设相对立

    -   类似"总体参数之间有显著差异"或"总体分布不符合正态分布"

    -   在NHST框架下，零假设($H_0$)和备择假设($H_1$)是相互对立的，只有一个假设是正确的。

## 

-   如果零假设是正确的，那么经过培训班培训后的6岁幼儿平均创造力潜质与正常幼儿没有差异

-   即经过培训班培训后的6岁幼儿平均创造力潜质与正常幼儿属于同一个分布

![](images/image-409156073.png){fig-align="center"}

## 

-   如果备择假设是正确的，那么经过培训班培训后的6岁幼儿平均创造力潜质与正常幼儿存在差异

-   即经过培训班培训后的6岁幼儿平均创造力潜质与正常幼儿不属于同一个分布

![](images/image-1440186196.png){fig-align="center"}

## 

</br></br></br>

<center>我们做出决策时，一定能保证该决策是正确的吗？</center>

## 两类错误

|            | $H_0$为真              | $H_1$为真              |
|------------|------------------------|------------------------|
| 结果显著   | False positive(假阳性) | True positive          |
| 结果不显著 | True negative          | False negative(假阴性) |

</br>

![](images/%E5%B9%BB%E7%81%AF%E7%89%8716.PNG){fig-align="center"}

## 

假设疾控中心在某地发现一例新冠肺炎感染者，现对该感染者的密接人群进行核酸检测。

## 

-   密切人群中的感染情况：

    -   红色实体小人为疾控中心已知的感染者</br>
    -   红色边框小人为疾控中心未知的感染者</br>
    -   黑色边框小人为疾控中心未知的非感染者</br>

![](images/image-421926042.png){fig-align="center"}

## 

-   假设我们开启上帝视角，知道该密接人群的真实情况

    -   红色边框小人为真实感染者</br>
    -   黑色边框小人为真实非感染者</br>

![](images/image-1121244084.png){fig-align="center"}

## 

-   在疾控中心视角，他们对该密接人群的状况是未知的，因此要进行核酸检测
    -   蓝色边框小人表示在进行核酸检测前，疾控中心假定该人群没有人被感染

![](images/image-887213021.png){fig-align="center"}

## 

-   在疾控中心视角，他们要根据核酸检测的结果采取进一步措施
    -   在进行核酸检测后，红色虚线边框小人结果为阳性，蓝色边框小人结果为阴性

![](images/image-625266086.png){fig-align="center"}

## 

-   在上帝视角，我们知道疾控中心的检测结果出现了差错
    -   红色方框为假阴性错误，蓝色方框为假阳性错误

![](images/image-435269648.png){fig-align="center"}

## 真实的两类错误发生概率是多大？

</br></br>

|            | $H_0$为真              | $H_1$为真              |
|------------|------------------------|------------------------|
| 结果显著   | False positive(假阳性) | True positive          |
| 结果不显著 | True negative          | False negative(假阴性) |

</br></br>

$H_0$为真的情况下，犯错误的概率为$\alpha$,又称**第一类错误**或**弃真错误**</br>

$H_1$为真的情况下，犯错误的概率为$\beta$,又称**第二类错误**或**取伪错误**

## 

</br></br>

|            | $H_0$为真                        | $H_1$为真                       |
|------------------|---------------------------|---------------------------|
| 结果显著   | False positive(假阳性)($\alpha$) | True positive($1-\beta$)        |
| 结果不显著 | True negative($1-\alpha$)        | False negative(假阴性)($\beta$) |

## 两类错误

</br></br>

-   $H_0$为真
    -   拒绝$H_0$:$\alpha$ = P(拒绝$H_0$\| $H_0$为真)
    -   不能拒绝$H_0$:1-$\alpha$ = P(不能拒绝$H_0$\| $H_0$为真)</br>

</br></br>

-   $H_1$为真
    -   不能拒绝$H_0$:$\beta$ = P(不能拒绝$H_0$\| $H_1$为真)
    -   拒绝$H_0$:1-$\beta$ = P(拒绝$H_0$\| $H_1$为真)

## 检测中的假阳性与假阴性到底有多高？

![](images/image-754605856.png){fig-align="center"}

## 

</br></br>

假设疾控中心发现某地有一例新冠肺炎感染者，某小区已封闭管理一个月，即将解封，现在疾控中心需要判断该小区是否存在疫情，他们做出正确决策或犯错误的概率是多少</br>

$H_0$:该感染者居住的小区不存在疫情

## 两类错误出现的真实概率

</br></br>

$$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(100%)                  | $H_1$为真(0%)                    |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

|               | $H_0$为真(100%)                 | $H_1$为真(0%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(5%) | 正确(0%)                        |
| 不能拒绝$H_0$ | 正确(95%)                       | **第二类错误**/**取伪错误**(0%) |

## 

</br></br>

假设疾控中心发现某地有一例新冠肺炎感染者，现在疾控中心需要判断该感染者的同事居住的小区是否存在疫情</br>

-   $H_0$:该感染者的同事居住的小区不存在疫情</br>

-   $H_1$:该感染者的同事居住的小区存在疫情</br>

如果该感染者的同事感染新冠的概率为50%，在此情况下，疾控中心做出正确决策或犯错误的概率是多少？

## 

</br></br> $$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(50%)                   | $H_1$为真(50%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

$$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(50%)                    | $H_1$为真(50%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(2.5%) | 正确(40%)                        |
| 不能拒绝$H_0$ | 正确(47.5%)                       | **第二类错误**/**取伪错误**(10%) |

## 小练习1

</br></br>

假设疾控中心发现某地有一例新冠肺炎感染者，现在疾控中心需要判断该感染者的同事居住的小区是否存在疫情</br>

-   𝐻_0:该感染者的同事居住的小区不存在疫情</br>

-   𝐻_1:该感染者的同事居住的小区存在疫情</br>

如果该感染者的同事感染新冠的概率为90%

## 

</br></br> $$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(10%)                   | $H_1$为真(90%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

$$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(10%)                    | $H_1$为真(90%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(0.5%) | 正确(72%)                        |
| 不能拒绝$H_0$ | 正确(9.5%)                        | **第二类错误**/**取伪错误**(18%) |

## 小练习2

</br></br>

假设疾控中心发现某地有一例新冠肺炎感染者，现在疾控中心需要判断该感染者的同事居住的小区是否存在疫情</br>

-   𝐻_0:该感染者的同事居住的小区不存在疫情</br>

-   𝐻_1:该感染者的同事居住的小区存在疫情</br>

如果该感染者的同事感染新冠的概率为95%

## 

</br></br>

$$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(5%)                    | $H_1$为真(95%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

$$\alpha=0.05,\beta=0.2$$

|               | $H_0$为真(5%)                      | $H_1$为真(95%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(0.25%) | 正确(76%)                        |
| 不能拒绝$H_0$ | 正确(4.75%)                        | **第二类错误**/**取伪错误**(19%) |

## 

</br></br> $$\alpha=0.01,\beta=0.2$$

|               | $H_0$为真(5%)                    | $H_1$为真(95%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

$$\alpha=0.01,\beta=0.2$$

|               | $H_0$为真(5%)                      | $H_1$为真(95%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(0.05%) | 正确(76%)                        |
| 不能拒绝$H_0$ | 正确(4.95%)                        | **第二类错误**/**取伪错误**(19%) |

## 

</br></br> $$\alpha=0.05,\beta=0.01$$

|               | $H_0$为真(5%)                    | $H_1$为真(95%)                   |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(？%) | 正确(？%)                        |
| 不能拒绝$H_0$ | 正确(？%)                        | **第二类错误**/**取伪错误**(？%) |

## 

</br></br>

$$\alpha=0.05,\beta=0.01$$

|               | $H_0$为真(5%)                      | $H_1$为真(95%)                     |
|------------------|---------------------------|---------------------------|
| 拒绝$H_0$     | **第一类错误**/**弃真错误**(0.25%) | 正确(94.05%)                       |
| 不能拒绝$H_0$ | 正确(4.75%)                        | **第二类错误**/**取伪错误**(0.95%) |

## 

![](images/image-1768482941.png){fig-align="center"}

<center>Nuzzo,2001,Nature</center>

# 功效分析(power analysis)

## 

![](images/image-743468415.png){fig-align="center"}

https://www.researchgate.net/figure/Statistical-hypothesis-testing-test-d-allowing-to-guarantee-a-prefixed-false-alarm-rate-l_fig3_331206334

## 

</br></br>

敏感性(Sensitivity)是指在真正呈阳性的条件下，出现阳性测试的概率，即$H_1$为真的情况下，拒绝$H_0$ 的概率

特异性(Specificity)是指在真正阴性的条件下，出现阴性测试的概率，即$H_0$为真的情况下，拒绝$H_0$ 的概率

## 

</br></br>

|               | $H_0$为真           | $H_1$为真           |
|---------------|---------------------|---------------------|
| 拒绝$H_0$     | 第一类错误/弃真错误 | **统计功效(power)** |
| 不能拒绝$H_0$ | 正确                | 第二类错误/取伪错误 |

## 统计功效的意义

$1-\beta$： 统计功效/敏感性

-   如果研究没有足够的统计功效，那么研究可能无法检测到真正的效果。这意味该研究很可能会浪费时间和金钱等资源，甚至从被试那里收集数据也可能是不道德的（尤其是在临床试验中）。

-   如果研究的统计功效很大，意味着该研究对真正的效果高度敏感，包括非常小的效果。这可能会导致发现在统计学上有意义的结果，但在现实世界中的用处很小。

## 影响统计功效的因素

-   效应量(effect size)

-   样本量(sample size)

## 效应量(effect size)

-   独立于样本容量，表明变量间实际关联强度的测度值，它可以定量帮助研究者判断统计学意义上的显著性结果是否有实际效用或实际效用的强度

![](images/image-540556860.png){fig-align="center"}

##

- 效应量大小表明变量之间的差异或群体之间的差异有多大意义，可以反映一项研究结果的实际意义。

- 大的效应大小意味着一项研究结果具有实际意义，而小的效应大小则表明实际应用有限。

## 

Cohen's d它采用两个平均值之间的差异并以标准差单位表示，这就可以使不同量纲之间的效应相互比较。</br>

$$$$