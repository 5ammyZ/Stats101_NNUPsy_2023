---
format: 
  revealjs:
    slide-number: true
    logo: images/image-393370223.png
    scrollable: true 
    theme: theme.scss
editor: visual
fontsize: 24pt
---

</br></br>

<h1 style="text-align: center">

14 - t检验

</h1>

<h2 style="text-align: center">

(t-test)

</h2>

</br></br>

<h3 style="text-align: center">

Hu Chuan-Peng

</h3>

<h3 style="text-align: center">

2023-05-31

</h3>

</br></br>

## Review

</br></br>

-   相关分析

    -   相关的定义

    -   相关系数

-   常见的相关系数

    -   皮尔逊积差相关

    -   斯皮尔曼等级相关

    -   肯德尔和谐系数

-   相关分析的应用

# 单样本假设检验(Single sample hypothesis testing)

## 假设检验步骤

![](images/1685439299495.jpg){fig-align="center"}

## 

![](images/1685440717044.jpg){fig-align="center"}

## 

![](images/1685440736950.jpg){fig-align="center"}

## 

![](images/1685440771665.jpg){fig-align="center"}

## 

![](images/1685440808512.jpg){fig-align="center"}

## 

![](images/1685440820070.jpg){fig-align="center"}

## z检验

</br></br>

某心理学家从受过专门训练的儿童中随机抽取64 名儿童进行韦克斯勒儿童智力测验(常模：$\mu_0= 100$,$\sigma_0 =15$。结果发现，这64名儿童的平均智商为105。问：能否认为这些接受了该项训练的儿童的智力高于其所在年龄组儿童的一般水平？

## 

</br></br>

问题1：接受训练的儿童的智商和正常儿童的智商是否存在差异？

问题2：接受训练的儿童的智商相比正常儿童的智商差多少？

## 

</br></br>

-   问题1：接受训练的儿童的智商和正常儿童的智商是否存在差异？ （假设检验）

-   问题2：接受训练的儿童的智商相比正常儿童的智商差多少？ （参数估计）

## 

![](images/1685441528950.jpg){fig-align="center"}

## 

</br></br>

在$H_0$成立的前提下，如何计算受训儿童的智力或者更极端智力水平出现的概率$p$？

## 

</br></br>

根据我们获得的数据，决定使用合适的统计模型

## 

</br></br>

每种模型都存在一定的预设，数据需要符合统计模型的预设

## z检验的预设(assumptions)

</br></br>

-   总体为正态分布</br></br>

-   样本量大于30</br></br>

-   样本平均数的抽样分布为正态分布

## t 检验的预设为：

</br></br>

-   总体为正态分布</br></br>

-   样本平均数的抽样分布为t分布

## 

</br></br>

某心理学家从受过专门训练的儿童中随机抽取64名儿童进行韦克斯勒儿童智力测验($mu_0$ = 100， $\sigma_0$ = 15)。结果发现，这64名儿童的平均智商为105。 问：能否认为这些接受了该项训练的儿童的智力高于其所在年龄组儿童的一般水平？

## 基本步骤

-   

    1.  提出假设</br></br>

    -   接受训练的儿童智力是否高于常模的平均水平 $\to$

    -   $H_0: \mu = \mu_1$

    -   $H_1: \mu_1 > \mu_0$

## 

![](images/1685456910044.jpg){fig-align="center"}

-   假定存在两个总体</br></br>

-   一个总体是正常孩子，</br></br>

-   另一个总体是超过正常智力水平的孩子

## 

-   

    2.  根据虚无假设$H_0$，选择相应的统计模型。</br></br>

    -   我们假定样本量为64的正常"儿童群体的平均智力"呈现正态分布，可使用z检验;</br></br>

    -   在使用z检验之前，需要检查数据是否满足z检验的预设。

## 

-   z检验的预设为：</br></br>

    -   总体为正态分布;</br></br>

    -   样本量大于30;</br></br>

    -   样本平均数的抽样分布为正态分布

## 如何检验正态分布

</br></br>

目视

![](images/1685457976625.jpg){fig-align="center"}

## 

S-W检验

![](images/1685460315899.jpg){fig-align="center"}

## 

Q-Q 图

![](images/1685460188306.jpg){fig-align="center"}

## 

</br></br>

-   3.确定显著性水平$\alpha$,$\alpha$确定后，否定域也随之被确定了。</br></br>

    -   指定$\alpha=0.05$(拒绝零假设犯错的可能性)；</br></br>

    -   单侧检验的临界点$Z_{0.05}=1.645$</br></br>

    -   注意：显著性水平意味着犯错误的可能性

## 

</br></br>

-   4.基于$H_0$所设定的统计模型，计算检验统计量的值。</br></br>

-   $\sigma_{\bar{X}} = \frac{\sigma_0}{\sqrt{n}}=\frac{15}{\sqrt{64}}=1.875,Z=\frac{\bar{X}-\mu_0}{\sigma_{\bar{X}}}=\frac{105-100}{1.875}=2.67$</br></br>

-   若总体方差未知，可使用样本方差进行计算$Z = \frac{\bar{X}-\mu_0}{\frac{S_{n-1}}{\sqrt{n}}}$

## 

</br></br>

-   5.做出决策</br></br>

    -   单侧检验的临界点$Z_{0.05}=1.645$ ;</br></br>

    -   $Z = 2.67 > Z_{0.05}$</br></br>

    -   在$\alpha=0.05$显著性水平上拒绝虚无假设，即$\mu_{\bar{X}}>\mu_0$

## 

</br></br>

-   假设检验的结果解读：</br></br>

    -   受训的学生为平均智商为105，我们可认为该培训对提高儿童在韦氏智力量表得分上有效，达到了统计上的显著性水平</br></br>

-   参数估计的结果解读：</br></br>

    -   受训的儿童与正常孩子的差异并非特别大。

## 单尾vs双尾

</br></br>

我们在上述问题中假设接受培训的孩子平均智商一定会高于正常孩子，存在一种可能该培训会使孩子的智商降低？如果存在的话，我们该如何考虑这个问题呢？

![](images/1685464736087.jpg){fig-align="center"}

## 结果呈现

</br></br>

接受培训的儿童与正常儿童相比较差异有统计学意义$(z = 2.67, p = 0.004, Cohen’s d = 0.33 , 95% CI : [0.08 , 0.59] )$, 可以认为该培训对儿童智力有影响，接受培训的儿童智力较正常儿童的智力更高。

## 练习

</br></br>

心理学家对某大学少年班的36名学生进行了韦克斯勒智力测验($\mu$ = 100， $\sigma$ = 15),结果这些少年班大学生的平均智商为132，标准差为9。那么是否可以认为这些少年班大学生的值上高于一般人的平均水平。

## 

</br></br>

作答内容</br></br>

-   明确并凝练问题（如：问题1：该样本飞行员的视 力和普通飞行员是否存在差异？）</br></br>

-   撰写假设检验5步骤</br></br>

-   进行规范化的结果表达

## 思考

对于该问题，除了假设检验还有其他解答方法吗？

![](images/1685465388688.jpg){fig-align="center"}

## 

</br></br>

-   对于肉眼可见的差异，我们不需要使用假设检验进行验证。</br></br>

-   在假设检验普及之前，研究者们并不依赖于假设检验来推断结果间的差异。</br></br>

## 

![](images/1685465811364.jpg){fig-align="center"}

## 

![](images/1685465826546.jpg){fig-align="center"}

<center>Stroop, J. R. (1935). Studies of interference in serial verbal reactions. Journal of Experimental Psychology, 18(6), 643--662. https://doi.org/10.1037/h0054651</center>

# 单样本t检验

</br></br>

一般来说，人的视觉反应时符合正态分布,且某心理学家研究发现，普通飞行员的平均视觉反应时为170ms，某人随机抽取25名飞行员进行测定，结果发现其平均视觉反应时为175ms，标准差$S_{n-1}$ 为15。问：能否根据测试结果而否定该心理学家的结论？

## 

</br></br>

问题1：该样本飞行员的视力和普通飞行员是否存在差异？</br></br>

问题2：该样本飞行员的视力相比普通飞行员的视力差多少？

## 

</br></br>

问题1：该样本飞行员的视力和普通飞行员是否存在差异？（假设检验）</br></br>

问题2：该样本飞行员的视力相比普通飞行员的视力差多少？（参数估计）

## 

![](images/1685492276931.jpg){fig-align="center"}

## 

</br></br>

我们该怎么计算$𝐻_0$成立下，该样本飞行员的视力超过正常总体均值的概率$p$

## 

</br></br>

-   t 检验的预设为</br></br>

    -   总体为正态分布</br></br>

    -   样本平均数的抽样分布为t 分布</br></br>

## 基本步骤

</br></br>

-   1.提出假设</br></br>

-   该样本飞行员的视力和普通飞行员是否存在差异，提出相应的虚无假设$𝐻_0$和研究假设$𝐻_1$，选择使用单侧检验。</br></br>

    -   $𝐻_0$：该样本飞行员的视力和普通飞行员没有差异， \$\mu\_0 = \mu\_1 \$ </br></br>

    -   $𝐻_1$：该样本飞行员的视力优于普通飞行员， \$\mu\_0 \< \mu\_1 \$ </br></br>

## 

![](images/1685492800540.jpg){fig-align="center"}

假定存在两个总体</br></br>

一个总体是普通飞行员</br></br>

另一个总体是样本飞行员

## 

</br></br>

-   

    2.  根据虚无假设𝐻_0，选择相应的统计模型。</br></br>

    -   我们假定样本量为25的样本飞行员"的视觉反应时"呈现正态分布，可使用t检验。</br></br>

    -   在使用t 检验之前，需要检查数据是否满足t检验的预设。</br></br>

## 

</br></br>

-   

    3.  确定显著性水平$\alpha$，$\alpha$确定后，否定域也随之被确定了。</br></br>

    -   指定$\alpha$ = 0.05（拒绝零假设犯错的可能性）。</br></br>

    -   单侧检验的临界点 $df$ = 24, $t_{0.05}=1.711$

## 

</br></br>

-   4.基于$H_0$所设定的统计模型，计算检验统计量的值。</br></br>

-   $S_{\bar{X}} = \frac{S_0}{\sqrt{n}}=\frac{15}{\sqrt{25}}=3,t=\frac{\bar{X}-\mu_0}{\frac{S_{n-1}}{\sqrt{n}}}=1.67$</br></br>

## 

</br></br>

-   5.做出决策</br></br>

    -   单侧检验的临界点$t_{0.05}=1.711$;</br></br>

    -   $t = 1.67 < t_{0.05}$</br></br>

    -   效应量$d = \frac{\bar{X}-\mu_0}{S_{n-1}}=\frac{175-170}{15}=0.3$

    -   在$\alpha=0.05$显著性水平上不能拒绝虚无假设，即$\mu_{\bar{X}}<\mu_0$

## 

</br></br>

样本飞行员的平均视觉反应时为175ms ，普通飞行员的平均视觉反应时为170ms，我们可以认为两者的差异没有达到统计上的显著水平。

## 

</br></br>

抽取的飞行员的平均视觉反应时与普通飞行员的平均视觉反应时相 比较差异没有统计学意义$(t (24) = 1.67, p > 0.05, Cohen’s d = 0.3, 95% CI : [-0.07 , 0.74])$, 可以认为抽取的飞行员与普通飞行员来自同一总体。

## 练习

</br></br>

在某空军招飞测试中，考官对报名者25人进行了光刺激下的简单反应时的测试，反应时平均值为175ms，标准差为15. 那么是否可以认为这些报名者总体上讲比普通飞行员（170ms）更慢一些?

## 作答内容

</br></br>

-   明确并凝练问题

    -   （如：问题1：该样本飞行员的视力和普通飞行员是否存在差异？）</br></br>

-   撰写假设检验5步骤</br></br>

-   进行规范化的结果表达</br></br>

## 零效应检验

我们能接受虚无假设(该样本飞行员的视力和普通飞行员没有差异)吗？ ![](images/1685492276931.jpg){fig-align="center"}

## 

</br></br>

-   在假设检验的框架下，p值表示在假定虚无假设为真的条件下出现当前数据的概率，p值并不能提供证据来接受虚无假设。</br></br>

-   若该心理学家想证明这些飞行员之间视力不存在差异，他该怎么办？(通过什么方法可以接受虚无假设)

## 

在假设检验的框架下，假设表述如下：

$𝐻_0$：该样本飞行员的视力和普通飞行员没有差异， $d = 0$。

$𝐻_1$：该样本飞行员的视力和普通飞行员存在差异， $d ≠ 0$。

![](images/1685494209012.jpg){fig-align="center"}

<center>Lakens, (2022). Improving Your Statistical Inferences. Chapter 9, https://doi.org/10.5281/zenodo.6409077. Built on 2022-05-29</center>

<center>许岳培, 陆春雷, ..., 胡传鹏. (2022). 应用心理学</center>

## 

实际上，研究者关心的效应量是否非常小，以至可以忽略。因此，可将虚无假设的效应量拓展为一个区间, 这种方法叫做最小效应量检验：

$𝐻_0$：该样本飞行员的视力和普通飞行员没有差异， $d = [-0.32, 0.32]$。

$𝐻_1$：该样本飞行员的视力和普通飞行员存在差异， $d > 0.32 或 d < -0.32$。

![](images/1685494374169.jpg){fig-align="center"}

<center>Lakens, (2022). Improving Your Statistical Inferences. Chapter 9, https://doi.org/10.5281/zenodo.6409077. Built on 2022-05-29</center>

<center>许岳培, 陆春雷, ..., 胡传鹏. (2022). 应用心理学</center>

## 

</br></br>

-   我们可以设定一个足够小的，几乎可以认为效应为零的区间，用于评估零效应。 </br></br>

-   这一区间即为"最小感兴趣的效应量区间"，简称为" 最小感兴趣区"（Smallest effect size of interest，SESOI）。</br></br>

-   目标效应量在SESOI内时，研究者可以认为效应量几乎为零，可以忽略不计。

## 

</br></br>

等价检验则正好将最小效应量检验的$𝐻_0$ 与$𝐻_1$所对应的效应区间对调， $𝐻_1$在区间之内，而$𝐻_0$在区间之外。

## 

在等价检验的框架下，虚无假设表述如下：

$𝐻_0$：该样本飞行员的视力和普通飞行员存在差异， $d > 0.32 或 d < -0.32$。

$𝐻_1$：该样本飞行员的视力和普通飞行员没有差异， $d = [-0.32, 0.32]$。

![](images/1685494526958.jpg){fig-align="center"}

<center>许岳培, 陆春雷, ..., 胡传鹏. (2022). 应用心理学</center>

## 

</br></br>

等价检验也可以通过基于参数估计的方法实现。频率统计框架 下，我们可以估计效应的值及其置信区间，然后根据效应量置信区间与 SESOI重合的比例进行推断。

## 

</br></br>

对上述数据分别进行单样本t检验和等价检验，结果如下：

![](images/1685494613906.jpg){fig-align="center"}

## 

对上述结果在原始分数上进行可视化：

![](images/1685494663926.jpg){fig-align="center"}

## 

</br></br>

-   因此，没有证据能够支持样本飞行员与普通飞行员的视力没有差异。</br></br>

-   在频率主义下，等价检验的最小感兴趣区间是根据情境来变化的，没有固定的规则。</br></br>

-   他的结果往往不一定是接受零效应，可能会出现既不能证明某个效应存在也不能证明某个效应不存在，是一个实验设计或者样本量存在问题。

## 

![](images/1685494853490.jpg){fig-align="center"}

<center>https://rpsychologist.com/d3/equivalence/</center>
