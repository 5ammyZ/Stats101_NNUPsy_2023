<!DOCTYPE html>
<html lang="en"><head>
<script src="lecture11_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture11_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture11_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture11_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture11_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture11_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lecture11_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <title>lecture11</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture11_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture11_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="lecture11_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="lecture11_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture11_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture11_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture11_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2">

<p><br><br></p>
<h1 style="text-align: center">
<p>11 - 假设检验(2)</p>
</h1>
<h2 style="text-align: center">
<p>(Hypothesis testing 2: Understand <em>p</em>-value)</p>
</h2>
<p><br><br></p>
<h3 style="text-align: center">
<p>Hu Chuan-Peng</p>
</h3>
<h3 style="text-align: center">
<p>2023-05-10</p>
</h3>
<p><br><br></p>
</section>
<section id="回顾review" class="slide level2">
<h2>回顾(review)</h2>
<p><br></p>
<ul>
<li><p>置信区间与假设检验(Confidence interval and hypothesis testing)</p></li>
<li><p>假设检验原理(how hypothesis testing works)</p></li>
</ul>
</section>
<section id="假设检验的步骤" class="slide level2">
<h2>假设检验的步骤:</h2>
<ul>
<li><ol type="1">
<li>提出假设；</li>
</ol></li>
<li><ol start="2" type="1">
<li>根据虚无假设<span class="math inline">\(𝐻_0\)</span>所提供的前提条件，选择合适的统计模型；</li>
</ol></li>
<li><ol start="3" type="1">
<li>规定显著性水平α；</li>
</ol></li>
<li><ol start="4" type="1">
<li>计算检验统计量的值；</li>
</ol></li>
<li><ol start="5" type="1">
<li>做出决策。</li>
</ol></li>
</ul>
</section>
<section id="section" class="slide level2">
<h2></h2>
<ul>
<li>南京某创造力培训班声称他们培训非常有效，在他们培训结束后36个6岁幼儿平均创造力潜质为105。假定正常的6岁幼儿的创造力潜质分数为100，标准差为15， 家长们想要了解该培训班是否真的有效，该如何决策？</li>
</ul>
</section>
<section id="基本步骤" class="slide level2">
<h2>基本步骤</h2>
<ul>
<li><p>1.提出假设。根据研究的问题，提出相应的虚无假设<span class="math inline">\(𝐻_0\)</span>和研究假设<span class="math inline">\(𝐻_1\)</span>，选择使用单侧检验。</p></li>
<li><p><span class="math inline">\(𝐻_0\)</span>：经过培训班培训后的6岁幼儿平均创造力潜质与正常幼儿没有差异。</p></li>
<li><p><span class="math inline">\(𝐻_1\)</span>：经过培训班培训后的6岁幼儿平均创造力潜质优于正常幼儿。</p></li>
</ul>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<ul>
<li><ol start="2" type="1">
<li>根据虚无假设<span class="math inline">\(𝐻_0\)</span>，对统计模型进行具体化。 6岁幼儿总体的平均创造力潜质𝑋̅呈现正态分布，可使用正态分布进行检验。</li>
</ol></li>
</ul>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<ul>
<li><ol start="3" type="1">
<li>确定显著性水平α，α确定后，否定域也随之被确定了。 指定α = 0.05（拒绝零假设犯错的可能性）。 单侧检验的临界点 <span class="math inline">\(𝑍_{0.05}\)</span>=1.645</li>
</ol></li>
</ul>

<img data-src="images/image1.png" class="r-stretch quarto-figure-center"></section>
<section id="section-3" class="slide level2">
<h2></h2>
<ul>
<li><ol start="4" type="1">
<li>基于H0所设定的统计模型，计算检验统计量的值。 <span class="math inline">\(\sigma_{\bar{X}} = \sigma_0/\sqrt{n} = 15/\sqrt{36} = 2.5\)</span>,</li>
</ol>
<span class="math inline">\(\quad Z = (\bar{X} - \mu_0)/\sigma_{\bar{X}} = (105 - 100)/2.5 = 2\)</span></li>
</ul>

<img data-src="images/image2.png" class="r-stretch quarto-figure-center"></section>
<section id="section-4" class="slide level2">
<h2></h2>
<ul>
<li>5.做出决策。 单侧检验的临界点 <span class="math inline">\(𝑍_{0.05}=1.645， 𝑍 = 2 &gt; 𝑍_0.05，\)</span></li>
</ul>
<p>在α = 0.05显著性水平上拒绝虚无假设，即 <span class="math inline">\(\mu_{\bar{x}} &gt; \mu_0\)</span>。</p>
</section>
<section>
<section id="p-值及其计算" class="title-slide slide level1 center">
<h1>1. <em>p</em> 值及其计算</h1>

</section>
<section id="基本步骤-1" class="slide level2">
<h2>基本步骤</h2>
<ul>
<li><p>Case 1:</p></li>
<li><p>正态分布</p></li>
<li><p>Standard error (SE) : <span class="math inline">\(\sigma_{\bar{X}} = \sigma_0/\sqrt{n} = 15/\sqrt{36} = 2.5, \quad Z = (\bar{X} - \mu_0)/\sigma_{\bar{X}} = (105 - 100)/2.5 = 2\)</span></p></li>
</ul>

<img data-src="images/image2.png" class="r-stretch quarto-figure-center"></section>
<section id="section-5" class="slide level2">
<h2></h2>
<ul>
<li><p>Case 2:</p></li>
<li><p>女士品茶：先加茶后加奶 VS 先加奶后加茶？</p></li>
</ul>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<ul>
<li><p>假如做了以下试验：</p>
<ul>
<li><p>（1）煮10杯茶，其中5杯先加奶，剩下5杯则是先加茶。</p></li>
<li><p>（2）这10杯茶被装在外观一样的茶杯当中，以随机的顺序被送去品尝；</p></li>
<li><p>（3）女士需要在品尝之后分辨出哪些是先加奶的，哪些是先加茶的。</p></li>
</ul></li>
<li><p>结果：</p>
<ul>
<li>该女士正确判断8杯奶茶。</li>
</ul></li>
</ul>
</section>
<section id="section-7" class="slide level2">
<h2></h2>

<img data-src="images/image3.png" class="r-stretch quarto-figure-center"></section>
<section id="section-8" class="slide level2">
<h2></h2>
<ul>
<li><p>1.提出假设。根据研究的问题，提出相应的虚无假设<span class="math inline">\(𝐻_0\)</span>和研究假设<span class="math inline">\(𝐻_1\)</span>，选择使用双侧检验还是单侧检验。</p>
<ul>
<li><p><span class="math inline">\(𝐻_0\)</span>：无法判断茶的制作顺序。</p></li>
<li><p><span class="math inline">\(𝐻_1\)</span>：能够判断茶的制作顺序（单侧）。</p></li>
</ul></li>
</ul>
</section>
<section id="section-9" class="slide level2">
<h2></h2>
<ul>
<li><ol start="2" type="1">
<li>根据虚无假设<span class="math inline">\(𝐻_0\)</span>所提供的前提条件，选择合适的统计模型。</li>
</ol>
<ul>
<li>对奶茶制做过程判断为正确或者错误，可视为伯努利试验，可用二项分布进行检验。</li>
</ul></li>
</ul>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
<ul>
<li><ol start="3" type="1">
<li>规定显著性水平<span class="math inline">\(\alpha\)</span></li>
</ol>
<ul>
<li><span class="math inline">\(\alpha\)</span> = 0.05，则如果该女士正确判断?杯奶茶后，可以拒绝<span class="math inline">\(H_0\)</span></li>
</ul></li>
</ul>
</section>
<section id="section-11" class="slide level2">
<h2></h2>

<img data-src="images/image4.png" class="r-stretch quarto-figure-center"></section>
<section id="section-12" class="slide level2">
<h2></h2>
<ul>
<li><ol start="4" type="1">
<li>计算检验统计量的值。</li>
</ol>
<ul>
<li><p>P (x = 8 | n = 10, p = .5) = 0.0439</p></li>
<li><p>P (x &gt;= 8 | n = 10, p = .5) = 0.0547</p></li>
<li><p>P (x &gt; = 9 | n = 10, p = .5) = 0.0107</p></li>
</ul></li>
</ul>

<img data-src="images/image5.png" class="r-stretch quarto-figure-center"></section>
<section id="section-13" class="slide level2">
<h2></h2>
<ul>
<li><ol start="5" type="1">
<li>做出决策。</li>
</ol>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> = 0.05</p></li>
<li><p>P (x &gt;= 8 | n = 10, p = .5) = 0.0547</p></li>
</ul></li>
</ul>
</section>
<section id="p-值" class="slide level2">
<h2><em>p</em> 值</h2>
<ul>
<li><p><span class="math inline">\(p-value :𝑝=𝑃(𝑑𝑎𝑡𝑎| 𝐻_0)\)</span></p></li>
<li><p>𝑝 = 𝑃(该女士正确判断8杯奶茶或以上 |“假设该女士完全没有分辨能力”) = 0.0547</p></li>
</ul>
</section>
<section id="section-14" class="slide level2">
<h2></h2>
<ul>
<li><p>小概率原理：</p>
<ul>
<li>小概率事件：发生的概率很小的事件，一般认为”小概率事件在一次试验中实际不会发生”。</li>
</ul></li>
<li><p>假设检验的原理：</p>
<ul>
<li>带有概率性质的反证法，不是”百分百的反证法”，是有可能犯错误的，这种错误被规定在一个小概率范围内。</li>
</ul></li>
</ul>
</section>
<section id="section-15" class="slide level2">
<h2></h2>
<ul>
<li><p>显著性水平α：研究者权衡后的”小概率”的上限。</p></li>
<li><p>否定域：</p>
<ul>
<li><p>在假设检验中，根据<span class="math inline">\(𝐻_0\)</span>建立的概率分布模型，由显著性水平α结合这些概率分布模型确定数轴上某些区间，检验统计量在其中出现的概率小于或等于α，则称这些区间为否定域。</p></li>
<li><p>否定域的界限为临界值。</p></li>
</ul></li>
</ul>
</section>
<section id="section-16" class="slide level2">
<h2></h2>

<img data-src="images/image6.png" class="r-stretch quarto-figure-center"></section>
<section id="section-17" class="slide level2">
<h2></h2>

<img data-src="images/image5.png" class="r-stretch quarto-figure-center"></section>
<section id="种情况" class="slide level2">
<h2>4 种情况</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(H_0\)</span>为真</th>
<th><span class="math inline">\(H_0\)</span>为假</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>不能拒绝<span class="math inline">\(H_0\)</span></td>
<td>√</td>
<td>×</td>
</tr>
<tr class="even">
<td>拒绝<span class="math inline">\(H_0\)</span></td>
<td>×</td>
<td><strong>√</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="p-值-1" class="slide level2">
<h2><em>p</em> 值</h2>
<ul>
<li><p><em>p</em>值衡量观察到的结果是否可归因于偶然。</p></li>
<li><p>不能给出期望的答案:假设是正确的概率是多少?</p></li>
<li><p>这些可能性取决于结果有多强，最重要的是，首先取决于假设的合理性。</p></li>
</ul>
</section>
<section id="p-值-2" class="slide level2">
<h2><em>p</em> 值</h2>
<ul>
<li><p>“假设原假设为真，我得到当前结果的概率是多少？”</p>
<ul>
<li><p><span class="math inline">\(p=𝑃(data|𝐻_0)\)</span></p></li>
<li><p>𝑝=𝑃(该女士正确判断8杯及以上|“假设该女士完全没有分辨能力”)</p></li>
</ul></li>
<li><p>“基于当前结果，原假设为真的概率是多少？”</p>
<ul>
<li><p>we can’t get : <span class="math inline">\(𝑃(𝐻_0 |𝑑𝑎𝑡𝑎)\)</span></p>
<ul>
<li>𝑃 (“该女士完全没有分辨能力” | 该女士正确判断8杯及以上)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="p-值-3" class="slide level2">
<h2><em>p</em> 值</h2>
<ul>
<li><p>We can get : <span class="math inline">\(𝑝=𝑃(𝑑𝑎𝑡𝑎| 𝐻_0)\)</span></p>
<ul>
<li>𝑝=𝑃(该女士正确判断8杯及以上|“假设该女士完全没有分辨能力”)</li>
</ul></li>
<li><p>we can’t get : <span class="math inline">\(𝑃(𝐻_0 |𝑑𝑎𝑡𝑎)\)</span></p>
<ul>
<li>𝑃 (“该女士完全没有分辨能力”| 该女士正确判断8杯及以上)</li>
</ul></li>
<li><p><span class="math inline">\(𝑃(𝑑𝑎𝑡𝑎| 𝐻_0)≠ 𝑃(𝐻_0|𝑑𝑎𝑡𝑎)\)</span></p></li>
</ul>
</section>
<section id="p-值的计算" class="slide level2">
<h2><em>p</em> 值的计算</h2>
<ul>
<li><p>正态分布</p></li>
<li><p>左侧检验的P值为检验统计量X 小于样本统计值C 的概率：</p>
<ul>
<li>P = P{ X &lt; C}</li>
</ul></li>
<li><p>右侧检验的P值为检验统计量X 大于样本统计值C 的概率：</p>
<ul>
<li>P = P{ X &gt; C}</li>
</ul></li>
</ul>
</section>
<section id="p-值的计算-1" class="slide level2">
<h2><em>p</em> 值的计算</h2>
<ul>
<li><p>正态分布</p>
<ul>
<li>双侧检验的P值为检验统计量X 落在样本统计值C 为端点的尾部区域内的概率的2 倍：P = 2P{ X &gt; C} (当C位于分布曲线的右端时) 或P = 2P{ X&lt; C} (当C 位于分布曲线的左端时) 。</li>
</ul></li>
</ul>
</section>
<section id="section-18" class="slide level2">
<h2></h2>
<ul>
<li>假定正常的6岁幼儿的创造力潜质分数为100，标准差为15，分别三个孩子的创造力潜质进行测量，所得结果分别为140，110，135，请问这三个孩子中是否存在创造力超常者？</li>
</ul>
</section>
<section id="section-19" class="slide level2">
<h2></h2>
<ul>
<li>从平均值为100，标准差为15的正态分布总体抽取100个样本，重复次数为10000次</li>
</ul>
</section>
<section id="section-20" class="slide level2">
<h2></h2>

<img data-src="images/image7.png" class="r-stretch quarto-figure-center"></section>
<section id="section-21" class="slide level2">
<h2></h2>
<ul>
<li>样本平均值在抽样分布中的位置</li>
</ul>

<img data-src="images/image8.png" class="r-stretch quarto-figure-center"></section>
<section id="section-22" class="slide level2">
<h2></h2>

<img data-src="images/image9.png" class="r-stretch quarto-figure-center"></section>
<section id="section-23" class="slide level2">
<h2></h2>

<img data-src="images/image10.png" class="r-stretch quarto-figure-center"></section></section>
<section>
<section id="p-值分布直方图" class="title-slide slide level1 center">
<h1><em>p</em> 值分布直方图</h1>

</section>
<section id="模拟p值分布是如何产生的" class="slide level2">
<h2>模拟(<em>p</em>值分布是如何产生的)</h2>
<div class="cell">

</div>
<h3 id="抽样分布">抽样分布</h3>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section></section>
<section id="z值分布" class="title-slide slide level1 center">
<h1>z值分布</h1>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>

<section id="p值分布双侧0.05" class="title-slide slide level1 center">
<h1><em>p</em>值分布(双侧0.05)</h1>
<p>注：由于坐标轴中，0表示[-0.025-0.025],1表示[0.975-1.025]，但p值分布的范围为0-1，所以两侧bin的density小只是图示原因，实际p值近似均匀分布</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>

<section>
<section id="p值分布单侧0.05" class="title-slide slide level1 center">
<h1>p值分布(单侧0.05)</h1>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="section-24" class="slide level2">
<h2></h2>
<ul>
<li><span class="math inline">\(H_0\)</span>在多大程度上可能为真-&gt;p值分布</li>
</ul>
<table>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(H_0\)</span>为真</th>
<th><span class="math inline">\(H_0\)</span>为假</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>不能拒绝<span class="math inline">\(H_0\)</span></td>
<td>√</td>
<td>×</td>
</tr>
<tr class="even">
<td>拒绝<span class="math inline">\(H_0\)</span></td>
<td>×</td>
<td><strong>√</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="section-25" class="slide level2">
<h2></h2>

<img data-src="images/image13.png" class="r-stretch quarto-figure-center"></section>
<section id="section-26" class="slide level2">
<h2></h2>

<img data-src="images/image14.png" class="r-stretch quarto-figure-center"><ul>
<li>Nuzzo,2001,Nature</li>
</ul>
</section>
<section id="p值的使用" class="slide level2">
<h2><em>p</em>值的使用</h2>

<img data-src="images/image15.png" class="r-stretch quarto-figure-center"><ul>
<li>Masicampo,2012,The Quarterly Journal of Experimental Psychology</li>
</ul>
</section>
<section id="section-27" class="slide level2">
<h2></h2>

<img data-src="images/image16.png" class="r-stretch quarto-figure-center"><ul>
<li>Masicampo,2012,The Quarterly Journal of Experimental Psychology</li>
</ul>
</section>
<section id="section-28" class="slide level2">
<h2></h2>

<img data-src="images/image17.png" class="r-stretch quarto-figure-center"><ul>
<li>Cristea,2018,PLoS One</li>
</ul>
</section>
<section id="section-29" class="slide level2">
<h2></h2>

<img data-src="images/image18.png" class="r-stretch quarto-figure-center"><ul>
<li>Cristea,2018,PLoS One</li>
</ul>
</section>
<section id="section-30" class="slide level2">
<h2></h2>
<ul>
<li>Chavalarias等人基于超过1200万篇MEDLINE摘要和80万篇PubMed Central（PMC）全文（包含摘要）的自动文本挖掘，系统阐述了过去25年（1990-2015年）生物医学文献中的<em>p</em> 值变化。</li>
</ul>

<img data-src="images/image19.png" class="r-stretch quarto-figure-center"><ul>
<li>Chavalarias D, 2016, JAMA</li>
</ul>
</section>
<section id="section-31" class="slide level2">
<h2></h2>

<img data-src="images/image20.png" class="r-stretch quarto-figure-center"><ul>
<li>Chavalarias D, 2016, JAMA</li>
</ul>
</section>
<section id="课堂练习" class="slide level2">
<h2>课堂练习</h2>
<ul>
<li><p>南京某创造力培训班声称他们培训非常有效，对经过培训后的36个6岁幼儿平均创造力潜质进行测量。经过计算<em>p</em> = 0.01, 以下是 6 个关于上述情境的 <em>p</em> 值的推断，请判断正误:</p></li>
<li><p>A.你完全证否了零假设;</p></li>
<li><p>B.你发现了零假设为真的概率;</p></li>
<li><p>C.你完全证明实验假设;</p></li>
<li><p>D.你可推断出实验假设为真的概率;</p></li>
<li><p>E.你可以得知, 你拒绝零假设时犯错的概率;</p></li>
<li><p>F.如果重复多次实验, 99%实验结果显著。</p></li>
</ul>
</section></section>
<section>
<section id="p-值的误用" class="title-slide slide level1 center">
<h1>2. <em>p</em> 值的误用</h1>

</section>
<section id="fallacy-1" class="slide level2">
<h2>Fallacy 1</h2>
<ul>
<li><p>A.你完全证否了零假设;</p></li>
<li><p>C.你完全证明实验假设;</p></li>
<li><p>零假设检验(NHST)无法提供关于科学或社会现象假设的”证明”。</p></li>
</ul>
<blockquote>
<p>http://www.theresear.ch/research/statistical-significance/p-value-replicability</p>
</blockquote>
</section>
<section id="fallacy-2" class="slide level2">
<h2>Fallacy 2</h2>
<ul>
<li><p>B.你发现了零假设为真的概率;</p></li>
<li><p>D.你可推断出实验假设为真的概率;</p></li>
<li><p>E.你可以得知, 你拒绝零假设时犯错的概率;</p>
<ul>
<li><em>p</em>值的计算前提是假设零假设为真，但是它不是假设成立的合理概率。</li>
<li><em>p</em>值只是表明数据符合零假设代表统计模型的程度。因此，<em>p</em> = 0.01表明数据与统计模型(包括所检验假设)预测的数据不太接近。</li>
</ul></li>
</ul>
</section>
<section id="fallacy-3" class="slide level2">
<h2>Fallacy 3</h2>
<ul>
<li><p>F.如果重复多次实验, 99%实验结果显著。</p></li>
<li><p>“Replication delusion”: one minus the p-value describes the probability of replication.</p></li>
<li><p>如果人们认为统计显著性是能够区分H0为真与H1为真的阈值，则继而认为统计显着的结果更容易被复制。</p></li>
<li><p>事实上，统计显著性仅是对统计检验结果是否符合<span class="math inline">\(H_0\)</span>模型程度的量化，而无法对产生数据的模型进行真正的解释，也无从预测重复实验的概率。</p></li>
</ul>
</section>
<section id="fallacy-3-1" class="slide level2">
<h2>Fallacy 3</h2>
<ul>
<li><p>F.如果重复多次实验, 99%实验结果显著。</p>
<ul>
<li><p>“Replication delusion”: one minus the p-value describes the probability of replication.</p></li>
<li><p><em>p</em> 值对样本大小和潜在效应大小以及实验和分析中出现的自然随机变化很敏感。即使重复实验，完全随机误差也会导致 <em>p</em> 值变化几个数量级。</p></li>
</ul></li>
</ul>
</section>
<section id="section-32" class="slide level2">
<h2></h2>

<img data-src="images/image21.png" class="r-stretch quarto-figure-center"><ul>
<li>胡传鹏等, 2016, 心理科学进展</li>
</ul>
</section>
<section id="section-33" class="slide level2">
<h2></h2>

<img data-src="images/image22.png" class="r-stretch quarto-figure-center"><ul>
<li>Lyu, X.-K., Xu, Y., Zhao, X.-F., Zuo, X.-N., &amp; Hu, C.-P. (2020). Beyond psychology: Prevalence of p value and confidence interval misinterpretation across different fields. <em>Journal of Pacific Rim Psychology, 14</em>. https://doi.org/10.1017/prp.2019.28</li>
</ul>
</section>
<section id="section-34" class="slide level2">
<h2></h2>

<img data-src="images/image23.png" class="r-stretch quarto-figure-center"><blockquote>
<p>http://www.theresear.ch/research/statistical-significance/psychologist-nhst-misinterpretations#nhst-main</p>
</blockquote>
</section>
<section id="section-35" class="slide level2">
<h2></h2>

<img data-src="images/image24.png" class="r-stretch quarto-figure-center"><blockquote>
<p>http://www.theresear.ch/research/statistical-significance/psychologist-nhst-misinterpretations#nhst-main</p>
</blockquote>
</section>
<section id="section-36" class="slide level2">
<h2></h2>

<img data-src="images/image25.png" class="r-stretch quarto-figure-center"><blockquote>
<p>Xiao-Kang Lyu et al.&nbsp;2021 Journal of Pacific Rim Psychology</p>
</blockquote>
</section>
<section id="section-37" class="slide level2">
<h2></h2>

<img data-src="images/image26.png" class="r-stretch quarto-figure-center"></section>
<section id="section-38" class="slide level2">
<h2></h2>

<img data-src="images/image27.png" class="r-stretch quarto-figure-center"><blockquote>
<p>Xiao-Kang Lyu et al.&nbsp;2021 Journal of Pacific Rim Psychology</p>
</blockquote>
</section>
<section id="fallacy-4" class="slide level2">
<h2>Fallacy 4</h2>
<ul>
<li><p>A non-significant p-value indicates no effect between the treatment and control.</p></li>
<li><p>这种错误的理解被称为无效谬误。</p></li>
<li><p>统计上不显著的结果（通常定义为大于0.05的<em>p</em>值）仅表明数据在零假设模型下并不”奇怪”。对于零假设本身是否为真并未提供任何信息。</p></li>
</ul>
</section>
<section id="fallacy-4-1" class="slide level2">
<h2>Fallacy 4</h2>
<ul>
<li><p>A non-significant p-value indicates no effect between the treatment and control.</p></li>
<li><table>
<colgroup>
<col style="width: 26%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Survey</strong></th>
<th><strong>Most recent time period*</strong></th>
<th><strong>No.&nbsp;of. articles w/ errors</strong></th>
<th><strong>Total No.&nbsp;of articles</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Schatz P, et</strong> <strong>al</strong> <strong>(2005).</strong></td>
<td><strong>2001-2004</strong></td>
<td><strong>81</strong></td>
<td><strong>170</strong></td>
</tr>
<tr class="even">
<td><strong>Fidler F, at al (2006).</strong></td>
<td><strong>2005</strong></td>
<td><strong>42</strong></td>
<td><strong>100</strong></td>
</tr>
<tr class="odd">
<td><strong>Hoekstra R, (2006).</strong></td>
<td><strong>2002-2004</strong></td>
<td><strong>145</strong></td>
<td><strong>259</strong></td>
</tr>
<tr class="even">
<td><strong>Bernardi</strong> <strong>F, et al (2017).</strong></td>
<td><strong>2010-2014</strong></td>
<td><strong>34</strong></td>
<td><strong>262</strong></td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="错误产生的原因" class="slide level2">
<h2>错误产生的原因</h2>
<ul>
<li><p><em>p</em> 值计算关键预设是原假设为真。较小的 <em>p</em>值仅表明观察到的数据与原假设不太兼容。这可能出于三个原因：</p>
<ul>
<li><p>原假设是错误的；</p></li>
<li><p>在数据中观察到很大的随机抽样误差；</p></li>
<li><p>统计模型不正确。</p></li>
<li><p>。。。</p></li>
</ul></li>
</ul>
</section>
<section id="错误产生的原因-1" class="slide level2">
<h2>错误产生的原因</h2>
<ul>
<li><p>即使由于原假设为假而生成了一个小的 <em>p</em>值，这并不总是具有实际意义。</p></li>
<li><p>统计显著性是对测试结果的解释，并未对产生数据的模型进行任何的探索。</p></li>
</ul>
</section>
<section id="错误产生的原因-2" class="slide level2">
<h2>错误产生的原因</h2>
<ul>
<li><p>具有统计学意义的 <em>p</em>值可能具有较高的误报风险。</p></li>
<li><p><em>p</em>值可能对数据中的随机误差敏感。</p></li>
<li><p>这些随机误差很容易导致<em>p</em>值超过统计显著性阈值。此外，如果非随机误差存在于数据生成过程中并且未在模型中明确说明，则它们将影响 <em>p</em> 值。</p></li>
</ul>
</section>
<section id="美国统计学会关于p-值的6个原则" class="slide level2">
<h2>美国统计学会关于<em>p</em> 值的6个原则</h2>
<ul>
<li><ol type="1">
<li>P-values can indicate how incompatible the data are with a specified statistical model .</li>
</ol>
<ul>
<li>(<em>p</em> 值可以表明数据与某个特定统计模型之间不相容程度。)</li>
</ul></li>
<li><ol start="2" type="1">
<li>P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.</li>
</ol>
<ul>
<li>(<em>p</em> 值不能衡量研究假设为真的概率, 也不能衡量数据仅 由随机因素造成的概率。)</li>
</ul>
<blockquote>
<p>Ronald L. Wasserstein &amp; Nicole A. Lazar (2016) The American Statistician</p>
</blockquote></li>
</ul>
</section>
<section id="section-39" class="slide level2">
<h2></h2>
<ul>
<li><ol start="3" type="1">
<li>Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.</li>
</ol>
<ul>
<li>(科学结论、商业或政策上的决策, 不应仅取决于 <em>p</em> 值是否达到了某个特定的阈值。)</li>
</ul></li>
<li><ol start="4" type="1">
<li>Proper inference requires full reporting and transparency .</li>
</ol>
<ul>
<li>(在完整报告和透明的基础上才能做出合理的推论。)</li>
</ul>
<h2 id="section-40"></h2></li>
<li><ol start="5" type="1">
<li>A p-value, or statistical significance, does not measure the size of an effect or the importance of a result.</li>
</ol>
<ul>
<li>(<em>p</em> 值或统计显著性并不能用来衡量效应的大小和结果的重要性。 )</li>
</ul></li>
<li><ol start="6" type="1">
<li>By itself, a p-value does not provide a good measure of evidence regarding a model or hypothesis.</li>
</ol>
<ul>
<li>(p值本身并不能衡量模型或假设的可信度。)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="误用p-值的危害" class="title-slide slide level1 center">
<h1>3. 误用<em>p</em> 值的危害</h1>

</section>
<section id="p-hacking" class="slide level2">
<h2>P-hacking</h2>
<ul>
<li><p>Simonsohn, “P-hacking is trying multiple things until you get the desired result”.</p></li>
<li><p>“<em>p</em> 值操纵就是不断地把数据量加倍，直到获得自己想要的结果。”这种行为甚至是下意识的。作者去掉了其中一种条件下的数据，使总体的<em>p</em>值小于0.05。“或者”她是个p值操纵者，总是一边收集数据一边看数据好不好。”</p></li>
</ul>
<blockquote>
<p>https://www.npr.org/sections/13.7/2014/06/02/318212713/science-trust-and-psychology-in-crisis</p>
</blockquote>
</section>
<section id="section-41" class="slide level2">
<h2></h2>
<ul>
<li>假定虚无假设为真的条件下，预计收集100个被试，在50个被试时分析一次，100个被试时分析一次。进行50000次模拟，各个<em>p</em>值出现的频次分析，可以看出在<em>p</em>刚刚小于0.05时的比例偏高。</li>
</ul>
</section>
<section id="section-42" class="slide level2">
<h2></h2>
<ul>
<li>假定虚无假设为真的条件下，预计收集100个被试，在50个被试时分析一次，100个被试时分析一次。进行50000次模拟，各个<em>p</em> 值出现的频次分析，可以看出在p 刚刚小于0.05时的比例偏高。</li>
</ul>

<img data-src="images/image28.png" class="r-stretch quarto-figure-center"></section>
<section id="模拟p-hacking的例子" class="slide level2">
<h2>模拟(<em>p</em>-hacking的例子)</h2>
<p>收集到50个被试时进行分析，若<em>p</em> &gt; 0.05,则继续搜集。</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="section-43" class="slide level2">
<h2></h2>
<p>收集到100个被试的情况，<em>p</em> &lt; 0.05的占比增大</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="section-44" class="slide level2">
<h2></h2>
<ul>
<li>在实验开始之前，确定你大约需要进行几次分析（比如打算收集50人数据，准备在10人、20人、30人、40人和50人时各分析一次，哪次显著了就停止），根据分析的次数，来确定α的阈限取多少。</li>
</ul>
</section>
<section id="模拟p-hacking的例子-1" class="slide level2">
<h2>模拟(<em>p</em>-hacking的例子)</h2>
<p>在搜集到10人时分析</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="section-45" class="slide level2">
<h2></h2>
<p>在搜集到20人时分析,此时<em>p</em> &lt; 0.05的占比为9.64%</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="section-46" class="slide level2">
<h2></h2>
<p>在搜集到30人时分析,此时<em>p</em> &lt; 0.05的占比为14.12%</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="section-47" class="slide level2">
<h2></h2>
<p>在搜集到40人时分析,此时p&lt;0.05的占比为18.48%,</p>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="section-48" class="slide level2">
<h2></h2>
<ul>
<li><p>在搜集到50人时分析,此时p&lt;0.05的占比为22.05%</p></li>
<li><p>根据模拟的数据来看，如果进行5次分析仍然使用0.05作为阈限的话，一类错误会变高</p></li>
<li><p><span class="math inline">\(\alpha\)</span> 应为0.01158</p></li>
</ul>

<img data-src="lecture11_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="section-49" class="slide level2">
<h2></h2>

<img data-src="images/image29.png" class="r-stretch quarto-figure-center"><ul>
<li>2012年发表在Science上的某篇文章，四个实验中，样本量不断增加，而p值却非常稳定地”恰好”小于0.05。</li>
</ul>
<blockquote>
<p>https://zhuanlan.zhihu.com/p/29317164?utm_source=wechat_session</p>
</blockquote>
</section>
<section id="section-50" class="slide level2">
<h2></h2>

<img data-src="images/image30.png" class="r-stretch quarto-figure-center"><ul>
<li>2015年大规模重复实验的分析表明，p值与能够成功重复之间的关系也比较有趣：P值在0.04以上和0.05以下的研究中，被重复出来的最少。</li>
</ul>
</section>
<section id="section-51" class="slide level2">
<h2></h2>

<img data-src="images/image31.png" class="r-stretch quarto-figure-center"><ul>
<li>Original study effect size versus replication effect size (correlation coefficients). Diagonal line represents replication effect size equal to original effect size. Dotted line represents replication effect size of 0. Points below the dotted line were effects in the opposite direction of the original. Density plots are separated by significant (blue) and nonsignificant (red) effects.</li>
</ul>
<blockquote>
<p>Open Science Collaboration, 2015, Science</p>
</blockquote>
</section>
<section id="section-52" class="slide level2">
<h2></h2>

<img data-src="images/image32.png" class="r-stretch quarto-figure-center"><ul>
<li>胡传鹏等，2016，《心理科学进展》</li>
</ul>
</section>
<section id="section-53" class="slide level2">
<h2></h2>

<img data-src="images/image33.png" class="r-stretch quarto-figure-center"><blockquote>
<p>Benjamin, D. J., Berger, J., Johannesson, M., Nosek, B. A., Wagenmakers, E., Berk, R., … Johnson, V. (2017, July 22). Redefine statistical significance.</p>
</blockquote>
</section>
<section id="小结" class="slide level2">
<h2>小结</h2>
<ul>
<li><p><em>p</em>值及其计算</p>
<ul>
<li><p><em>p</em>值的定义（条件概率）</p></li>
<li><p><em>p</em>值的计算</p></li>
<li><p><em>p</em>值的分布</p></li>
</ul></li>
<li><p><em>p</em>值的误用</p>
<ul>
<li><p>对<em>p</em>值的误解</p></li>
<li><p>误解产生的原因</p></li>
<li><p>如何正确解读<em>p</em>值</p></li>
</ul></li>
<li><p>误用<em>p</em>值的危害</p>
<ul>
<li><p>P-hacking</p></li>
<li><p>可重复危机</p></li>
</ul></li>
</ul>

<img src="images/image-393370223.png" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture11_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture11_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture11_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lecture11_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>